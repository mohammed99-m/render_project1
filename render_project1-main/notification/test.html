<!DOCTYPE html>
<html>
<head>
    <title>Real-time Notification Test</title>
</head>
<body>
    <h1>ğŸ”” Real-time Notification Test</h1>

    <div id="notifications" style="border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;">
        <strong>Notifications:</strong>
    </div>

    <button onclick="likePost()">ğŸ‘ Like Post</button>

    <script>
        const userid = 5;  // ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ·Ø§Ø¨Ù‚ Ù†ÙØ³ room_name ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±
        const socket = new WebSocket("wss://render-project1-qyk2.onrender.com/ws/notification/5/");

        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            const div = document.getElementById("notifications");
            div.innerHTML += `<p>${data.notification.notification}</p>`;
        };

        socket.onopen = function(e) {
            console.log("âœ… WebSocket connected.");
        };
        socket.onerror = function(error) {
            console.error("âŒ WebSocket error:", error);
        };

        function likePost() {
            fetch("http://localhost:8000/posts/like/1/4/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => response.json().then(data => ({status: response.status, body: data})))
            .then(result => {
                const { status, body } = result;

                if (status === 201) {
                    alert("âœ… ØªÙ… Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±!");
                } else if (status === 500) {
                    alert("âš ï¸ ØªÙ… Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ ÙˆÙ„ÙƒÙ† ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±.");
                } else {
                    alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: " + JSON.stringify(body));
                }

                console.log("ğŸ“¨ Response:", body);
            })
            .catch(error => {
                console.error("âŒ Error sending like:", error);
                alert("âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±." + error.message);
            });
        }
    </script>
</body>
</html>